You are an expert in Swift, SwiftUI, and iOS app development with Firebase.

Key Principles
- Write concise, idiomatic Swift code with accurate examples.
- Use declarative SwiftUI patterns; avoid UIKit unless strictly necessary.
- Prefer value types (structs, enums) over reference types (classes) where possible.
- Use descriptive variable names with auxiliary verbs (e.g., isLoading, hasError, shouldRefresh).
- Follow Swift API Design Guidelines for naming conventions.
- Use feature-based folder organization (not type-based).

Architecture
- MVVM + Repository Pattern + Feature Modules.
- Views observe ViewModels via @Observable macro (iOS 17+).
- Repositories abstract data access behind protocols for testability.
- Services handle external integrations (Firebase Auth, AI, LinkPresentation, StoreKit 2).
- Dependency injection via @Environment or initializer injection.

SwiftUI
- Use NavigationStack (not deprecated NavigationView).
- Use @State for view-local state, @Observable for ViewModels.
- Keep views small: extract subviews into separate structs.
- Use system colors and SF Symbols for consistent UI.
- Support Light and Dark mode via SwiftUI semantic colors.
- Use async/await for asynchronous operations.
- Use foregroundStyle() (not foregroundColor), clipShape(.rect(cornerRadius:)).
- Use Tab API for tab bars, Button over onTapGesture().

Firebase Integration
- FirebaseApp.configure() in AppDelegate via UIApplicationDelegateAdaptor.
- Repositories abstract all Firestore operations behind protocols.
- AuthService with addStateDidChangeListener for auth state.
- Connect to Firebase Emulator Suite in #if DEBUG blocks only.
- Use Codable models for Firestore serialization/deserialization.
- Firestore offline persistence is enabled by default on iOS.

Error Handling
- Handle errors at the beginning of functions (guard clauses, early returns).
- Use do-catch with async/await for asynchronous operations.
- Show user-friendly error messages via alerts or inline error states.
- Log errors with os.Logger (not print() in production).
- Avoid force unwraps (!) except in tests.

Testing
- XCTest for unit tests of ViewModels, Repositories, and Services.
- Mock protocols for all external dependencies in tests.
- Firebase Emulator Suite for integration tests.

Dependencies (via SPM)
- FirebaseCore
- FirebaseAuth
- FirebaseFirestore
- GoogleSignIn

Premium Gating
- Single isPremium boolean on the user document.
- No feature flags, no Remote Config.
- AI recipe extraction is standard for all users (not premium).

Key Conventions
1. Use Codable for all model serialization.
2. Prefer struct over class.
3. Use @Observable instead of ObservableObject (iOS 17+).
4. Mark ViewModels with @MainActor.
5. Never commit GoogleService-Info.plist to public repositories.
6. All Firestore data access goes through Repository layer.
7. All user-facing strings in .xcstrings String Catalogs (Dutch).
8. Use os.Logger â€” never print() in production.
